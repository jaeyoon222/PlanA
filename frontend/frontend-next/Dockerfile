# 1λ‹¨κ³„: λΉλ“
FROM node:20-alpine AS builder

WORKDIR /app
COPY . .

# π”¥ λΉλ“ μ‹μ μ— API μ£Όμ† μ£Όμ…
ARG NEXT_PUBLIC_API_BASE
ENV NEXT_PUBLIC_API_BASE=$NEXT_PUBLIC_API_BASE

RUN npm install
RUN npm run build

# 2λ‹¨κ³„: μ‹¤ν–‰
FROM node:20-alpine

WORKDIR /app
COPY --from=builder /app ./

# μ‹¤ν–‰ μ‹ 3000 ν¬νΈ μ¤ν”
EXPOSE 3000

# β… μ™Έλ¶€ μ ‘μ† κ°€λ¥ν•λ„λ΅ -H 0.0.0.0
CMD ["npx", "next", "start", "-H", "0.0.0.0"]
